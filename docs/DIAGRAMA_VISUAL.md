# 🎯 DIAGRAMA VISUAL - FLUXO DA AUTOMAÇÃO

## 📊 FLUXO PRINCIPAL (Visão Geral)

```
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   FASE 1        │    │   FASE 2        │    │   FASE 3        │
│ INICIALIZAÇÃO   │───▶│  LIMPEZA E      │───▶│ OBTENÇÃO DE     │
│                 │    │  PREPARAÇÃO     │    │ EMAILS          │
└─────────────────┘    └─────────────────┘    └─────────────────┘
         │                       │                       │
         ▼                       ▼                       ▼
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   FASE 4        │    │   FASE 5        │    │   FASE 6        │
│ VALIDAÇÃO DE    │◀───│ PROCESSAMENTO   │───▶│ GERAÇÃO DE      │
│ CREDENCIAIS     │    │ DE EMAILS       │    │ RELATÓRIOS      │
└─────────────────┘    └─────────────────┘    └─────────────────┘
```

## 🔄 LOOP DE PROCESSAMENTO (FASE 5)

```
                    ┌─────────────────────────────────────┐
                    │        FILA DE EMAILS               │
                    │    Email 1, Email 2, ..., Email N  │
                    └─────────────────┬───────────────────┘
                                      │
                                      ▼
                    ┌─────────────────────────────────────┐
                    │         PARA CADA EMAIL             │
                    └─────────────────┬───────────────────┘
                                      │
                                      ▼
    ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
    │    PASSO 1      │    │    PASSO 2      │    │    PASSO 3      │
    │ Validar Número  │───▶│ Verificar se    │───▶│ Loop de         │
    │   Sinistro      │    │ Está Encerrado  │    │ Tentativas      │
    └─────────────────┘    └─────────────────┘    └─────────────────┘
            │                       │                       │
            ▼                       ▼                       ▼
    ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
    │   ❌ Inválido   │    │ ⏹️ Encerrado    │    │ ✅ Processar    │
    │ Próximo Email   │    │ Próximo Email   │    │    Email        │
    └─────────────────┘    └─────────────────┘    └─────────────────┘
```

## 🎯 LOOP DE TENTATIVAS (PASSO 3)

```
┌─────────────────────────────────────────────────────────────┐
│                    TENTATIVA 1 até MAX_RETRIES             │
└─────────────────────┬───────────────────────────────────────┘
                      │
                      ▼
    ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
    │  SUB-PASSO 1    │    │  SUB-PASSO 2    │    │  SUB-PASSO 3    │
    │ Configurar      │───▶│ Realizar        │───▶│ Executar        │
    │ Navegador       │    │ Login           │    │ Navegação       │
    └─────────────────┘    └─────────────────┘    └─────────────────┘
            │                       │                       │
            ▼                       ▼                       ▼
    ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
    │ ❌ Falha        │    │ ❌ Falha        │    │    RESULTADO    │
    │ Nova Tentativa  │    │ Nova Tentativa  │    │      ???        │
    └─────────────────┘    └─────────────────┘    └─────────────────┘
                                                           │
                        ┌──────────────────────────────────┼──────────────────────────────────┐
                        │                                  │                                  │
                        ▼                                  ▼                                  ▼
            ┌─────────────────┐                ┌─────────────────┐                ┌─────────────────┐
            │ RESULTADO: 1    │                │ RESULTADO: -1   │                │ RESULTADO: 0    │
            │ ✅ SUCESSO      │                │ 🔒 ENCERRADO   │                │ ❌ FALHA        │
            │ Email Confirmação│               │ Histórico OK    │                │ Nova Tentativa │
            └─────────────────┘                └─────────────────┘                └─────────────────┘
```

## 🧭 FLUXO DE NAVEGAÇÃO DETALHADO

```
                            ┌─────────────────┐
                            │   NAVEGAÇÃO     │
                            │    INICIADA     │
                            └─────────┬───────┘
                                      │
                                      ▼
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│      N1         │    │      N2         │    │      N3         │    │      N4         │
│ Menu Sinistros  │───▶│ Opção Busca     │───▶│ Vista Padrão    │───▶│ Buscar Sinistro │
└─────────────────┘    └─────────────────┘    └─────────────────┘    └─────────────────┘
         │                       │                       │                       │
         ▼                       ▼                       ▼                       ▼
    【FALLBACK】           【FALLBACK】           【FALLBACK】           【FALLBACK】
  Selenium → JS         Selenium → JS         Selenium → JS         Selenium → JS

                                      ┌─────────────────┐
                                      │      N5         │
                            ┌────────▶│ Abrir Sinistro  │
                            │         └─────────────────┘
                            │                  │
                            │                  ▼
                            │         ┌─────────────────┐
                            │         │      N6         │
                            │         │ Verificar Status│
                            │         └─────────┬───────┘
                            │                   │
                            │         ┌─────────┼─────────┐
                            │         │                   │
                            │         ▼                   ▼
                            │ ┌─────────────────┐ ┌─────────────────┐
                            │ │   🔒 ENCERRADO  │ │  ✅ ATIVO      │
                            │ │   Só Histórico  │ │ Fluxo Completo  │
                            │ └─────────────────┘ └─────────┬───────┘
                            │                               │
                            └───────────────────────────────┘
                                                            │
                                                            ▼
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│      N7         │    │      N8         │    │      N9         │    │      N10        │
│ Editar Sinistro │───▶│ Acessar         │───▶│ Adicionar       │───▶│ Preencher       │
│                 │    │ Histórico       │    │ Atualização     │    │ Formulário      │
└─────────────────┘    └─────────────────┘    └─────────────────┘    └─────────────────┘
                                                                              │
                                                                              ▼
                                                            ┌─────────────────────────────────┐
                                                            │         N10 DETALHADO           │
                                                            │                                 │
                                                            │ ┌─────────────────┐            │
                                                            │ │ N10.1: Tipo     │            │
                                                            │ │ Informe (00029) │            │
                                                            │ └─────────────────┘            │
                                                            │           │                     │
                                                            │           ▼                     │
                                                            │ ┌─────────────────┐            │
                                                            │ │ N10.2: Observa- │            │
                                                            │ │ ções (Cabeçalho)│            │
                                                            │ └─────────────────┘            │
                                                            │           │                     │
                                                            │           ▼                     │
                                                            │ ┌─────────────────┐            │
                                                            │ │ N10.3: Comentá- │            │
                                                            │ │ rios (CLIPBOARD)│            │
                                                            │ └─────────────────┘            │
                                                            └─────────────────────────────────┘
                                                                              │
                                                                              ▼
                            ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
                            │      N11        │    │      N12        │    │      N13        │
                            │ Salvar          │───▶│ Atualizar       │───▶│ Salvar          │
                            │ Histórico       │    │ Telefone        │    │ Alterações      │
                            └─────────────────┘    └─────────────────┘    └─────────────────┘
                                                            │                       │
                                                            ▼                       ▼
                                                    【OPCIONAL】             ┌─────────────────┐
                                                  Campo pode não            │ ✅ SUCESSO (1) │
                                                  existir - OK              │ 🔒 ENCERRADO(-1)│
                                                                            │ ❌ FALHA (0)    │
                                                                            └─────────────────┘
```

## 🎯 SISTEMA DE FALLBACKS

```
                            ┌─────────────────┐
                            │   AÇÃO DESEJADA │
                            └─────────┬───────┘
                                      │
                                      ▼
                            ┌─────────────────┐
                            │   MÉTODO 1      │
                            │   (SELENIUM)    │
                            └─────────┬───────┘
                                      │
                            ┌─────────▼─────────┐
                            │    SUCESSO?       │
                            └─────────┬─────────┘
                                      │
                            ┌─────────▼─────────┐
                            │       SIM         │    │       NÃO        │
                            └───────────────────┘    └─────────┬────────┘
                                      │                        │
                                      ▼                        ▼
                            ┌─────────────────┐      ┌─────────────────┐
                            │ ✅ CONTINUAR    │      │   MÉTODO 2      │
                            │                 │      │  (JAVASCRIPT)   │
                            └─────────────────┘      └─────────┬───────┘
                                                               │
                                                     ┌─────────▼─────────┐
                                                     │    SUCESSO?       │
                                                     └─────────┬─────────┘
                                                               │
                                                     ┌─────────▼─────────┐
                                                     │  SIM  │    │  NÃO │
                                                     └───────┘    └──┬───┘
                                                         │           │
                                                         ▼           ▼
                                               ┌─────────────────┐ ┌─────────────────┐
                                               │ ✅ CONTINUAR    │ │ ❌ FALHA        │
                                               │                 │ │ LOG ERRO        │
                                               └─────────────────┘ └─────────────────┘
```

## 📧 FLUXO ESPECÍFICO - PREENCHIMENTO DE COMENTÁRIOS

```
                    ┌─────────────────────────────────────┐
                    │      TEXTO LONGO DETECTADO          │
                    │      Campo: Comentários             │
                    └─────────────────┬───────────────────┘
                                      │
                                      ▼
                    ┌─────────────────────────────────────┐
                    │         MÉTODO CLIPBOARD            │
                    └─────────────────┬───────────────────┘
                                      │
                                      ▼
    ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
    │    PASSO 1      │    │    PASSO 2      │    │    PASSO 3      │
    │ Salvar Clipboard│───▶│ Copiar Texto    │───▶│ Clicar Campo    │
    │   Original      │    │  para Clipboard │    │  Comentários    │
    └─────────────────┘    └─────────────────┘    └─────────────────┘
                                                           │
                                                           ▼
    ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
    │    PASSO 4      │    │    PASSO 5      │    │    PASSO 6      │
    │ Colar Conteúdo  │───▶│ Restaurar       │───▶│ Verificar       │
    │    (Ctrl+V)     │    │ Clipboard       │    │  Resultado      │
    └─────────────────┘    └─────────────────┘    └─────────────────┘
                                                           │
                                          ┌─────────────────▼─────────────────┐
                                          │           RESULTADO               │
                                          └─────────────────┬─────────────────┘
                                                            │
                                          ┌─────────────────▼─────────────────┐
                                          │ ✅ SUCESSO  │  │ ❌ FALHA        │
                                          └─────────────┘  └─────────┬───────┘
                                                                     │
                                                                     ▼
                                                          ┌─────────────────┐
                                                          │    FALLBACK     │
                                                          │   send_keys()   │
                                                          └─────────────────┘
```

## 📊 MÉTRICAS E CONTROLE

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                              DASHBOARD DE CONTROLE                          │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  📧 EMAILS PROCESSADOS              📈 TAXA DE SUCESSO                      │
│  ┌─────────────────────────────┐    ┌─────────────────────────────┐         │
│  │ Total: 15                   │    │ Sucessos: 12 (80%)          │         │
│  │ Processados: 12             │    │ Falhas: 3 (20%)             │         │
│  │ Falharam: 3                 │    │ Taxa Alvo: >85%             │         │
│  └─────────────────────────────┘    └─────────────────────────────┘         │
│                                                                             │
│  ⏱️ TEMPO DE EXECUÇÃO               🔄 TENTATIVAS                            │
│  ┌─────────────────────────────┐    ┌─────────────────────────────┐         │
│  │ Total: 45min 32s            │    │ Média: 1.8 tentativas/email │         │
│  │ Média/Email: 3min 2s        │    │ Max Retries: 3              │         │
│  │ Mais Lento: 8min 15s        │    │ Emails 1 tentativa: 8       │         │
│  └─────────────────────────────┘    └─────────────────────────────┘         │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

## 🚨 INDICADORES DE STATUS

```
STATUS DO SISTEMA:
┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐
│ 🟢 OPERACIONAL  │  │ 🟡 ATENÇÃO     │  │ 🔴 CRÍTICO     │
│                 │  │                 │  │                 │
│ • Outlook: OK   │  │ • Taxa < 85%    │  │ • Login falhou  │
│ • Login: OK     │  │ • Timeout alto  │  │ • Sem emails    │
│ • Navegação: OK │  │ • Retry alto    │  │ • Sistema down  │
└─────────────────┘  └─────────────────┘  └─────────────────┘
```

---

*Diagrama atualizado em: {{ current_date }}*